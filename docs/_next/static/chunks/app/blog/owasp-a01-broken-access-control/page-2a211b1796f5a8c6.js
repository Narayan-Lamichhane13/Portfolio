(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[982],{3067:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(2898).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5589:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s(2898).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},1107:function(e,t,s){Promise.resolve().then(s.bind(s,9879))},9879:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var n=s(7437),r=s(1396),i=s.n(r),a=s(732),c=s(3067),o=s(5589);function l(e){let{code:t,language:s}=e;return(0,n.jsx)("pre",{className:"bg-zinc-950 border border-zinc-800 rounded-xl p-4 overflow-x-auto text-sm text-gray-200",children:(0,n.jsx)("code",{children:s?"// ".concat(s,"\n").concat(t):t})})}function d(e){let{title:t,children:s}=e;return(0,n.jsxs)("section",{className:"mt-10",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:t}),(0,n.jsx)("div",{className:"space-y-4 text-gray-300",children:s})]})}function h(){return(0,n.jsx)("div",{className:"min-h-screen bg-black",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20 pt-28",children:[(0,n.jsxs)(i(),{href:"/blog",className:"inline-flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-8",children:[(0,n.jsx)(c.Z,{className:"w-5 h-5"}),"Back to Blog"]}),(0,n.jsxs)(a.E.header,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.4},className:"mb-10",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,n.jsx)("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-xl",children:(0,n.jsx)(o.Z,{className:"w-6 h-6 text-white"})}),(0,n.jsx)("span",{className:"text-sm text-gray-400 font-medium",children:"OWASP Top 10"})]}),(0,n.jsx)("h1",{className:"text-4xl md:text-5xl font-bold mb-3 text-white",children:"A01: Broken Access Control"}),(0,n.jsx)("p",{className:"text-lg text-gray-400",children:"Broken access control happens when an app fails to enforce authorization rules consistently, letting users access data or actions they shouldn't."})]}),(0,n.jsxs)(d,{title:"What it is (and why it matters)",children:[(0,n.jsxs)("p",{className:"text-gray-400",children:["Authentication answers ",(0,n.jsx)("em",{children:"who you are"}),". Authorization answers ",(0,n.jsx)("em",{children:"what you're allowed to do"}),". A01 issues appear when endpoints trust client-supplied identifiers (like ",(0,n.jsx)("code",{className:"text-purple-400",children:"userId"})," or ",(0,n.jsx)("code",{className:"text-purple-400",children:"accountId"}),") without verifying ownership/permissions on the server."]}),(0,n.jsx)("p",{className:"text-gray-400",children:"Common symptoms include IDOR (Insecure Direct Object Reference), missing role checks, and server-side enforcement that exists in some routes but not others."})]}),(0,n.jsxs)(d,{title:"Vulnerable example (IDOR)",children:[(0,n.jsx)("p",{className:"text-gray-400",children:"This endpoint returns an invoice by ID, but it never checks that the invoice belongs to the logged-in user."}),(0,n.jsx)(l,{language:"TypeScript (Express-style)",code:"app.get('/api/invoices/:id', async (req, res) => {\n  const invoice = await db.invoice.findUnique({ where: { id: req.params.id } })\n  return res.json(invoice) // ❌ missing authorization check\n})"})]}),(0,n.jsxs)(d,{title:"Safer pattern (enforce ownership/roles server-side)",children:[(0,n.jsxs)("p",{className:"text-gray-400",children:["Fetch by ",(0,n.jsx)("strong",{children:"both"})," the object ID and the authenticated user, or enforce a policy/ACL check before returning data."]}),(0,n.jsx)(l,{language:"TypeScript (Express-style)",code:"app.get('/api/invoices/:id', async (req, res) => {\n  const userId = req.auth.userId\n\n  const invoice = await db.invoice.findFirst({\n    where: { id: req.params.id, ownerUserId: userId },\n  })\n\n  if (!invoice) return res.status(404).json({ error: 'Not found' })\n  return res.json(invoice)\n})"})]}),(0,n.jsx)(d,{title:"Practical checklist",children:(0,n.jsx)("p",{className:"text-gray-400",children:"Centralize authorization (middleware/policy layer), deny-by-default, and add automated tests for “cannot access other user's resource” cases. Log authorization failures to help detect probing."})})]})})}}},function(e){e.O(0,[206,396,971,938,744],function(){return e(e.s=1107)}),_N_E=e.O()}]);