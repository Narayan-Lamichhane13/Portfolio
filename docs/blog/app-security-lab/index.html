<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/Portfolio/_next/static/css/b9108665b9042eae.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/Portfolio/_next/static/chunks/webpack-846dee99ed2a3616.js" crossorigin=""/><script src="/Portfolio/_next/static/chunks/fd9d1056-7cae991e1db5da4d.js" async="" crossorigin=""></script><script src="/Portfolio/_next/static/chunks/938-07965c5a53dbf27a.js" async="" crossorigin=""></script><script src="/Portfolio/_next/static/chunks/main-app-4d33b04fb69f037a.js" async="" crossorigin=""></script><script src="/Portfolio/_next/static/chunks/206-d0cdc6c16777b06d.js" async=""></script><script src="/Portfolio/_next/static/chunks/396-34609a8f63f59d00.js" async=""></script><script src="/Portfolio/_next/static/chunks/app/blog/app-security-lab/page-38245761029adf2e.js" async=""></script><script src="/Portfolio/_next/static/chunks/app/layout-3373ed84a0a49f96.js" async=""></script><title>Narayan Lamichhane | Portfolio</title><meta name="description" content="Product Management &amp; Cybersecurity Enthusiast"/><script src="/Portfolio/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="__className_41aa3d"><nav class="fixed top-0 left-0 right-0 z-50 bg-black/80 backdrop-blur-md border-b border-zinc-800"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex items-center justify-between h-16"><a class="flex items-center space-x-2" href="/Portfolio/"><div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center"><span class="text-white font-bold text-xl">N</span></div><span class="font-bold text-xl hidden sm:block text-white">Narayan Lamichhane</span></a><div class="flex items-center space-x-1"><a class="relative" href="/Portfolio/"><div class="flex items-center space-x-2 px-4 py-2 rounded-lg transition-all text-gray-400 hover:text-white" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-home w-5 h-5"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg><span class="font-medium hidden sm:inline">About</span></div></a><a class="relative" href="/Portfolio/experience/"><div class="flex items-center space-x-2 px-4 py-2 rounded-lg transition-all text-gray-400 hover:text-white" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-building2 w-5 h-5"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"></path><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"></path><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"></path><path d="M10 6h4"></path><path d="M10 10h4"></path><path d="M10 14h4"></path><path d="M10 18h4"></path></svg><span class="font-medium hidden sm:inline">Experience</span></div></a><a class="relative" href="/Portfolio/projects/"><div class="flex items-center space-x-2 px-4 py-2 rounded-lg transition-all text-gray-400 hover:text-white" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-briefcase w-5 h-5"><rect width="20" height="14" x="2" y="7" rx="2" ry="2"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path></svg><span class="font-medium hidden sm:inline">Projects</span></div></a><a class="relative" href="/Portfolio/blog/"><div class="flex items-center space-x-2 px-4 py-2 rounded-lg transition-all text-gray-400 hover:text-white" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield w-5 h-5"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"></path></svg><span class="font-medium hidden sm:inline">Security Blog</span></div></a></div></div></div></nav><main class="min-h-screen"><div class="min-h-screen bg-black"><div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20 pt-28"><a href="/Portfolio/blog/"><button class="flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-8" style="opacity:0;transform:translateX(-20px) translateZ(0)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left w-5 h-5"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg>Back to Blog</button></a><div class="mb-12" style="opacity:0;transform:translateY(20px) translateZ(0)"><div class="flex items-center gap-3 mb-4"><div class="p-3 bg-gradient-to-br from-red-500 to-orange-500 rounded-xl"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield w-6 h-6 text-white"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"></path></svg></div><span class="text-sm text-gray-400 font-medium">Application Security</span></div><h1 class="text-4xl md:text-5xl font-bold mb-4 text-white">Application Security Lab — From Native Exploits to Web Attacks</h1><p class="text-lg text-gray-400">A deep dive into real-world exploitation techniques, from stack overflows to web vulnerabilities</p></div><article class="prose prose-invert max-w-none" style="opacity:0"><div class="mb-12"><h2 class="text-3xl font-bold text-white mb-6 border-b border-zinc-800 pb-3">Goal &amp; Threat Model</h2><div class="text-gray-300 space-y-4"><p>The lab simulates real attack paths against vulnerable programs and web apps. The objective is to escalate control from simple input fields to full shell access and data exfiltration by chaining small, reliable primitives. I focused on:</p><ul><li><strong>Native binaries (C/x86)</strong>: stack/heap overflows, DEP/NX bypass (ret2libc/ret2syscall), unsafe unlink on heap.</li><li><strong>Web apps (HTML/JS/SQL)</strong>: SQL Injection, CSRF, and persistent XSS with stealth, spying, and robustness across filters.</li></ul></div></div><div class="mb-12"><h2 class="text-3xl font-bold text-white mb-6 border-b border-zinc-800 pb-3">Part A — Native Binary Exploitation (C/x86)</h2><div class="text-gray-300 space-y-4"><h3 class="text-2xl font-bold text-white mt-8 mb-4">Tools &amp; Setup</h3><p><code class="text-purple-400">gdb</code> (disassembly, breakpoints, memory maps), <code class="text-purple-400">objdump/readelf/strings</code> (gadgets, symbol offsets), <code class="text-purple-400">Python</code> (payload generators with struct.pack), and careful control of ASLR/DEP/PIE to understand constraints.</p><h3 class="text-2xl font-bold text-white mt-8 mb-4">1) Stack Overflow 101: measure → build → verify</h3><p class="text-gray-300 mb-4"><strong>Concept:</strong> Overwrite the saved return address (RET) on the stack by copying more bytes than a local buffer can hold.</p><h4 class="text-xl font-semibold text-white mt-6 mb-3">Steps</h4><div class="mb-6"><p class="text-gray-300 mb-2"><strong>Find buffer size &amp; offset</strong></p><p class="text-gray-400 mb-3">In <code class="text-purple-400">vulnerable()</code> you&#x27;ll see something like:</p><div class="my-4 bg-zinc-950 border border-zinc-800 rounded-lg overflow-hidden"><div class="flex items-center gap-2 px-4 py-2 bg-zinc-900 border-b border-zinc-800"><div class="flex gap-1.5"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div></div><div class="flex items-center gap-2 ml-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal w-4 h-4 text-gray-500"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg><span class="text-xs text-gray-500 font-mono">bash</span></div></div><div class="p-4 font-mono text-sm"><pre class="text-green-400 whitespace-pre-wrap">sub $0x64, %esp  → buf = 0x64 = 100 bytes</pre></div></div><p class="text-gray-400 mt-2">Offset to RET = buf size (100) + saved EBP (4) = 104.</p></div><div class="mb-6"><p class="text-gray-300 mb-2"><strong>Craft payload</strong></p><div class="my-4 bg-zinc-950 border border-zinc-800 rounded-lg overflow-hidden"><div class="flex items-center gap-2 px-4 py-2 bg-zinc-900 border-b border-zinc-800"><div class="flex gap-1.5"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div></div><div class="flex items-center gap-2 ml-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal w-4 h-4 text-gray-500"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg><span class="text-xs text-gray-500 font-mono">bash</span></div></div><div class="p-4 font-mono text-sm"><pre class="text-green-400 whitespace-pre-wrap">Layout = b&quot;A&quot;*100 + b&quot;B&quot;*4 + &lt;new RET&gt;.
Initially, use a NOP sled + shellcode and point RET into the sled.</pre></div></div></div><div class="mb-6"><p class="text-gray-300 mb-2"><strong>Verify in gdb</strong></p><div class="my-4 bg-zinc-950 border border-zinc-800 rounded-lg overflow-hidden"><div class="flex items-center gap-2 px-4 py-2 bg-zinc-900 border-b border-zinc-800"><div class="flex gap-1.5"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div></div><div class="flex items-center gap-2 ml-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal w-4 h-4 text-gray-500"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg><span class="text-xs text-gray-500 font-mono">bash</span></div></div><div class="p-4 font-mono text-sm"><pre class="text-green-400 whitespace-pre-wrap">Break at vulnerable, run with payload, then x/i $eip after crash/stop
to ensure EIP lands where you expect.</pre></div></div></div><div class="bg-zinc-900 border border-zinc-800 rounded-lg p-4 my-6"><p class="text-sm text-gray-400 mb-2"><strong class="text-white">Why it works:</strong></p><p class="text-gray-400">strcpy/gets/sprintf do no bounds check; exceeding the local buffer overwrites control data.</p><p class="text-sm text-gray-400 mt-3 mb-2"><strong class="text-white">Defenses:</strong></p><p class="text-gray-400">Use -fstack-protector-strong, safe functions (snprintf, strlcpy), PIE+ASLR, W^X.</p></div><h3 class="text-2xl font-bold text-white mt-8 mb-4">2) &quot;Safer copy&quot; bug + indirect write</h3><p class="text-gray-300 mb-4"><strong>Concept:</strong> Even &quot;safer&quot; functions can be dangerous if used incorrectly (e.g., copying <code class="text-purple-400">sizeof(buf) + k</code>). Combine that with an accidental write (<code class="text-purple-400">*p = a</code>) to redirect control indirectly.</p><h4 class="text-xl font-semibold text-white mt-6 mb-3">Steps</h4><div class="mb-6"><p class="text-gray-300 mb-3"><strong>Read the code path:</strong></p><div class="my-4 bg-zinc-950 border border-zinc-800 rounded-lg overflow-hidden"><div class="flex items-center gap-2 px-4 py-2 bg-zinc-900 border-b border-zinc-800"><div class="flex gap-1.5"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div></div><div class="flex items-center gap-2 ml-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal w-4 h-4 text-gray-500"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg><span class="text-xs text-gray-500 font-mono">bash</span></div></div><div class="p-4 font-mono text-sm"><pre class="text-green-400 whitespace-pre-wrap">If strncpy(buf, arg, sizeof(buf)+8) writes past the buffer,
it corrupts adjacent locals (like p/a).</pre></div></div></div><p class="text-gray-400 mb-3"><strong>Turn it into control:</strong> Arrange values so the later write <code class="text-purple-400">*p = a</code> stores a chosen address into a chosen location (write-what-where).</p><p class="text-gray-400 mb-3"><strong>Target:</strong> Overwrite the saved RET or a function pointer with the address of your sled/shellcode.</p><div class="bg-zinc-900 border border-zinc-800 rounded-lg p-4 my-6"><p class="text-sm text-gray-400"><strong class="text-white">Defenses:</strong> Correct length math, remove unsafe post-copy writes, compiler hardening, and bounds-checked APIs.</p></div><h3 class="text-2xl font-bold text-white mt-8 mb-4">3) Beyond Strings: file-driven overflow using alloca(count*4) wrap</h3><p class="text-gray-300 mb-4"><strong>Concept:</strong> The program reads a 32-bit count then allocates <code class="text-purple-400">count*4</code> bytes on the stack with <code class="text-purple-400">alloca</code>. If <code class="text-purple-400">count*4</code> overflows, the allocation becomes tiny but the read loop still writes count integers → a deterministic overflow.</p><h4 class="text-xl font-semibold text-white mt-6 mb-3">Steps</h4><div class="space-y-4 mb-6"><div><p class="text-gray-300 mb-2">Choose count to force wrap:</p><div class="my-4 bg-zinc-950 border border-zinc-800 rounded-lg overflow-hidden"><div class="flex items-center gap-2 px-4 py-2 bg-zinc-900 border-b border-zinc-800"><div class="flex gap-1.5"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div></div><div class="flex items-center gap-2 ml-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal w-4 h-4 text-gray-500"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg><span class="text-xs text-gray-500 font-mono">bash</span></div></div><div class="p-4 font-mono text-sm"><pre class="text-green-400 whitespace-pre-wrap">0x40000001 → count*4 == 4</pre></div></div></div><div><p class="text-gray-300 mb-2">Lay out the file:</p><div class="my-4 bg-zinc-950 border border-zinc-800 rounded-lg overflow-hidden"><div class="flex items-center gap-2 px-4 py-2 bg-zinc-900 border-b border-zinc-800"><div class="flex gap-1.5"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div></div><div class="flex items-center gap-2 ml-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal w-4 h-4 text-gray-500"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg><span class="text-xs text-gray-500 font-mono">bash</span></div></div><div class="p-4 font-mono text-sm"><pre class="text-green-400 whitespace-pre-wrap">[count][NOP sled + shellcode][padding to saved RET][RET overwrite]</pre></div></div></div><div><p class="text-gray-300 mb-2">Run so the reader loop overwrites saved RET with your sled address.</p></div><div><p class="text-gray-300 mb-2">Verify:</p><div class="my-4 bg-zinc-950 border border-zinc-800 rounded-lg overflow-hidden"><div class="flex items-center gap-2 px-4 py-2 bg-zinc-900 border-b border-zinc-800"><div class="flex gap-1.5"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div></div><div class="flex items-center gap-2 ml-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal w-4 h-4 text-gray-500"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg><span class="text-xs text-gray-500 font-mono">bash</span></div></div><div class="p-4 font-mono text-sm"><pre class="text-green-400 whitespace-pre-wrap">In gdb, break after allocation, measure buf address and delta to RET,
then size the file accordingly.</pre></div></div></div></div><div class="bg-zinc-900 border border-zinc-800 rounded-lg p-4 my-6"><p class="text-sm text-gray-400"><strong class="text-white">Defenses:</strong> Validate count and multiplication overflow; prefer heap with checks; add canaries.</p></div><h3 class="text-2xl font-bold text-white mt-8 mb-4">4) DEP/NX Bypass: ret2libc or ret2syscall</h3><p class="text-gray-300 mb-4"><strong>Problem:</strong> With DEP/NX, the stack is non-executable, so injected shellcode won&#x27;t run.</p><h4 class="text-xl font-semibold text-white mt-6 mb-3">4a) ret2libc (dynamic binaries)</h4><p class="text-gray-300 mb-4"><strong>Idea:</strong> Don&#x27;t execute stack bytes—return into libc and call existing functions.</p><ul class="space-y-3 mb-6 text-gray-400"><li>Find offset (e.g., 104).</li><li>Addresses needed: <code class="text-purple-400">system</code>, <code class="text-purple-400">exit</code>, and<!-- --> <code class="text-purple-400">&quot;/bin/sh&quot;</code>.</li><li>If symbols available: <code class="px-2 py-1 bg-zinc-900 text-purple-400 rounded text-sm font-mono">p system, find ... &quot;/bin/sh&quot;</code></li><li>If stripped: libc base (from <code class="text-purple-400">info proc mappings</code>) + offsets → absolute addresses.</li></ul><div class="my-4 bg-zinc-950 border border-zinc-800 rounded-lg overflow-hidden"><div class="flex items-center gap-2 px-4 py-2 bg-zinc-900 border-b border-zinc-800"><div class="flex gap-1.5"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div></div><div class="flex items-center gap-2 ml-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal w-4 h-4 text-gray-500"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg><span class="text-xs text-gray-500 font-mono">bash</span></div></div><div class="p-4 font-mono text-sm"><pre class="text-green-400 whitespace-pre-wrap">Payload: A*100 + B*4 + system + exit + &quot;/bin/sh&quot;</pre></div></div><p class="text-gray-400 mt-4"><strong>Variation:</strong> Use <code class="text-purple-400">exit@plt</code> from your binary via <code class="text-purple-400">objdump -d | grep @plt</code>.</p><h4 class="text-xl font-semibold text-white mt-8 mb-3">4b) ret2syscall (static binaries, no libc)</h4><p class="text-gray-300 mb-4"><strong>Idea:</strong> ROP to set registers and trigger <code class="text-purple-400">int 0x80</code> →<!-- --> <code class="text-purple-400">execve(&quot;/bin/sh&quot;,0,0)</code>.</p><ul class="space-y-3 mb-6 text-gray-400"><li>Find gadgets (pop/pop/ret, int 0x80) with objdump.</li><li>Chain sets <code class="text-purple-400">eax=11</code> (execve), <code class="text-purple-400">ebx=addr(&quot;/bin/sh&quot;)</code>,<!-- --> <code class="text-purple-400">ecx=0</code>, <code class="text-purple-400">edx=0</code> → <code class="text-purple-400">int 0x80</code>.</li></ul><div class="bg-zinc-900 border border-zinc-800 rounded-lg p-4 my-6"><p class="text-sm text-gray-400"><strong class="text-white">Defenses:</strong> Full ASLR, PIE, CFI, RELRO, and syscall filtering (seccomp).</p></div><h3 class="text-2xl font-bold text-white mt-8 mb-4">5) Heap Unlink Exploitation (doubly-linked list)</h3><p class="text-gray-300 mb-4"><strong>Concept:</strong> A manual doubly-linked list performs:</p><div class="my-4 bg-zinc-950 border border-zinc-800 rounded-lg overflow-hidden"><div class="flex items-center gap-2 px-4 py-2 bg-zinc-900 border-b border-zinc-800"><div class="flex gap-1.5"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div></div><div class="flex items-center gap-2 ml-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal w-4 h-4 text-gray-500"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg><span class="text-xs text-gray-500 font-mono">c</span></div></div><div class="p-4 font-mono text-sm"><pre class="text-green-400 whitespace-pre-wrap">if (node-&gt;prev) node-&gt;prev-&gt;next = node-&gt;next;
if (node-&gt;next) node-&gt;next-&gt;prev = node-&gt;prev;</pre></div></div><p class="text-gray-400 mt-4 mb-6">If you can overflow data to corrupt prev/next, deleting the node becomes a write-what-where.</p><h4 class="text-xl font-semibold text-white mt-6 mb-3">Steps</h4><div class="space-y-4 mb-6"><div><p class="text-gray-300 mb-2"><strong>Layout:</strong></p><div class="my-4 bg-zinc-950 border border-zinc-800 rounded-lg overflow-hidden"><div class="flex items-center gap-2 px-4 py-2 bg-zinc-900 border-b border-zinc-800"><div class="flex gap-1.5"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div></div><div class="flex items-center gap-2 ml-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal w-4 h-4 text-gray-500"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg><span class="text-xs text-gray-500 font-mono">c</span></div></div><div class="p-4 font-mono text-sm"><pre class="text-green-400 whitespace-pre-wrap">struct node { prev; next; data[32]; }. Strings go into data via strcpy.</pre></div></div></div><div><p class="text-gray-300 mb-2"><strong>Overflow forward</strong> from node B into node C to set:</p><div class="my-4 bg-zinc-950 border border-zinc-800 rounded-lg overflow-hidden"><div class="flex items-center gap-2 px-4 py-2 bg-zinc-900 border-b border-zinc-800"><div class="flex gap-1.5"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div></div><div class="flex items-center gap-2 ml-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal w-4 h-4 text-gray-500"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg><span class="text-xs text-gray-500 font-mono">bash</span></div></div><div class="p-4 font-mono text-sm"><pre class="text-green-400 whitespace-pre-wrap">c-&gt;prev = TARGET-4, c-&gt;next = VALUE</pre></div></div></div><div><p class="text-gray-300 mb-2"><strong>Delete(C)</strong> → writes <code class="text-purple-400">*(TARGET) = VALUE</code> (4-byte arbitrary write).</p></div><div><p class="text-gray-300 mb-2"><strong>Target</strong> a function pointer called at exit (e.g., <code class="text-purple-400">.fini_array/.dtors</code>), set it to a heap trampoline: a short <code class="text-purple-400">jmp +N</code> that lands in your real shellcode stored in A→data.</p></div><div><p class="text-gray-300 mb-2"><strong>Verify:</strong></p><div class="my-4 bg-zinc-950 border border-zinc-800 rounded-lg overflow-hidden"><div class="flex items-center gap-2 px-4 py-2 bg-zinc-900 border-b border-zinc-800"><div class="flex gap-1.5"><div class="w-3 h-3 rounded-full bg-red-500"></div><div class="w-3 h-3 rounded-full bg-yellow-500"></div><div class="w-3 h-3 rounded-full bg-green-500"></div></div><div class="flex items-center gap-2 ml-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-terminal w-4 h-4 text-gray-500"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" x2="20" y1="19" y2="19"></line></svg><span class="text-xs text-gray-500 font-mono">bash</span></div></div><div class="p-4 font-mono text-sm"><pre class="text-green-400 whitespace-pre-wrap">Inspect heap node addresses in gdb (finish after list_insert),
confirm pointer overwrite, then observe control at process exit.</pre></div></div></div></div><div class="bg-zinc-900 border border-zinc-800 rounded-lg p-4 my-6"><p class="text-sm text-gray-400"><strong class="text-white">Defenses:</strong> Safe unlink checks, hardened allocators, RELRO, no raw strcpy into heap structs.</p></div></div></div><div class="mb-12"><h2 class="text-3xl font-bold text-white mb-6 border-b border-zinc-800 pb-3">Reliability &amp; Hygiene</h2><div class="text-gray-300 space-y-4"><ul class="space-y-3 text-gray-400"><li><strong class="text-white">NUL-safe bytes</strong> in argv/file payloads (avoid <code class="text-purple-400">\x00</code> in addresses when passing via argv).</li><li><strong class="text-white">Endianness:</strong> pack addresses little-endian (<code class="text-purple-400">&quot;&lt;I&quot;</code>).</li><li><strong class="text-white">Repeatability:</strong> control ASLR in the lab (<code class="text-purple-400">set disable-randomization on</code>) while you learn; test with ASLR to understand real-world stability.</li><li><strong class="text-white">Gating:</strong> Always verify where EIP lands (<code class="text-purple-400">x/i $eip</code>), and prove overwrite distance with controlled patterns before dropping full chains.</li></ul></div></div></article></div></div></main><script src="/Portfolio/_next/static/chunks/webpack-846dee99ed2a3616.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/Portfolio/_next/static/css/b9108665b9042eae.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I[7690,[],\"\"]\n5:I[7831,[],\"\"]\n6:I[9257,[\"206\",\"static/chunks/206-d0cdc6c16777b06d.js\",\"396\",\"static/chunks/396-34609a8f63f59d00.js\",\"732\",\"static/chunks/app/blog/app-security-lab/page-38245761029adf2e.js\"],\"\"]\n7:I[5613,[],\"\"]\n8:I[1778,[],\"\"]\n9:I[2609,[\"206\",\"static/chunks/206-d0cdc6c16777b06d.js\",\"396\",\"static/chunks/396-34609a8f63f59d00.js\",\"185\",\"static/chunks/app/layout-3373ed84a0a49f96.js\"],\"\"]\nb:I[8955,[],\"\"]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/Portfolio/_next/static/css/b9108665b9042eae.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"cZMOhlHHkPHxzzt6YwQSB\",\"assetPrefix\":\"/Portfolio\",\"initialCanonicalUrl\":\"/blog/app-security-lab/\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[\"app-security-lab\",{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[\"app-security-lab\",{\"children\":[\"__PAGE__\",{},[\"$L4\",[\"$\",\"$L5\",null,{\"propsForComponent\":{\"params\":{}},\"Component\":\"$6\",\"isStaticGeneration\":true}],null]]},[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"app-security-lab\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__className_41aa3d\",\"children\":[[\"$\",\"$L9\",null,{}],[\"$\",\"main\",null,{\"className\":\"min-h-screen\",\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}]]}]}],null]],\"initialHead\":[false,\"$La\"],\"globalErrorComponent\":\"$b\"}]]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Narayan Lamichhane | Portfolio\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Product Management \u0026 Cybersecurity Enthusiast\"}]]\n4:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>